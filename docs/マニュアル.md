# マニュアル

## 問題の設定について

### スロット.xlsxについて

スロットに登場する問題は、`スロット.xlsx`に登録してください。構成ルールなどは`docs/シート構成ルール.md`をご覧ください。テンプレートとして、`スロット-テンプレート.xlsx`を用意しています。

#### 設定方法

- Que_L、Que_C、Que_Rシートに、それぞれ、問題の左、中央、右パーツと、それぞれの属性を加える。
- LR、LC、CRシートに、それぞれ左と右で繋げられる属性のリスト、左と中央で繋げられる属性のリスト、中央と右で繋げられる属性のリストを書き込む。
- `開発`フォルダに`スロット.xlsx`を移動する。
- `make_anssheet.py`を起動。(属性ルールに従って問題の羅列と、パーツを組み合わせた問題の羅列と、解答を作るためのAIに投げるために使うtxtが生成されます)
(この時点で、できた問題を見て不自然な問題がないかをチェックすること。ミスが見つかった場合、属性の設定を見直す。)
- 生成された`Problems.txt`をAIに投げる。プロンプトは以下を参考にしてください。
- AIが出力したjson`answers.json`という名前で保存して、`開発`フォルダに入れる。
- `import_answers.py`を起動する。(Ansシートにjsonの内容読み込まれます。) 
- `スロット.xlsx`を`ローンチ`フォルダに戻す。

```sample_prompt
アップロードしたProblemsの解答をjsonファイルで出力してください。具体的には、出力するjsonファイルのl問目の解答が以下のようになるようにしてください:

    "id_1": (Problemsの左の番号),
    "id_2": (Problemsの真ん中の番号),
    "id_3": (Problemsの右の番号),
    "D": (解答),
    "E": (誤答例1),
    "F": (誤答例2),
    "G": (誤答例3)

ここに、(解答)はProblemsのl行目の問題の解答です。

なお、変数lは1からsまでの範囲を動きます。ここに、sはProblemsの行数を指します。(今回のケースならs=154)
これは、コードを書かずに手作業で埋めてください。
なお、解答する際には以下の制約を満たすこと:
1.解答の初めに「絶対に」=をつけないこと
2.指数表記を使う際には^を用いること
3.三角関数がらみの解答をするときは、sin,cos,tan以外は使わないこと(例えばsecを使いたいときは、1/cosとすること)
4.整数/整数「のみ」で答えたいときは、必ず初めに'をつけること。
```

#### 仕様
- 解答の列、誤答の列を空欄にしていると、スロットに登場しません。微妙な問題ができた時はそのように対処してください。
- `make_anssheet.py`はAnsシートにまだ加えられていない問題のみを追加します。これは、上の対処法で削除した問題が再生成されるのを防ぐためです。
- 問題の追加に伴いAnsシートを書き直す必要がある場合、それまでのAnsシートを一度リセットする必要はありません。

## カスタマイズ

### 問題データの変更
`スロット.xlsx`ファイルを編集して、新しい問題を追加できます。

### デザインの変更
`index.html`の`<style>`セクションを編集して、見た目をカスタマイズできます。

### 音響の調整
`slot-audio.js`の`masterVolume`プロパティを変更して音量を調整できます。

### ゲーム設定の変更
`slot-logic.js`で以下の設定を変更できます：
- 制限時間（デフォルト: 60秒）
- スロットが停止するまでの時間（デフォルト: 3秒）
- 問題の重複回避設定

### デバッグ機能
ブラウザのコンソールで以下のコマンドが使用できます：
- `getSlotDebugInfo()` - デバッグ情報を表示
- `getCurrentSlotState()` - 現在のスロット状態を確認