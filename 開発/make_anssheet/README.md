# スロット問題生成ツール

複雑なExcelファイルの設定手順を簡単にするWebアプリケーションです。

## 機能

- Excelファイルの自動検証
- 制約条件に基づく問題の組み合わせ生成
- Problems.txtの自動生成・ダウンロード
- AI解答のJSONインポート
- 完成したスロット.xlsxの生成・ダウンロード

## 使用方法

1. **index.html**をブラウザで開く
2. 以下の手順に従って操作する：

### Step 1: Excelファイルをアップロード
- スロット問題の設定が含まれたExcelファイルを選択
- ファイルが正常に読み込まれると次のステップが有効になります

### Step 2: ファイル構造を検証
- 「検証を開始」ボタンをクリック
- 必要なシートと列名が正しく設定されているかチェック
- エラーがある場合は詳細が表示されます

### Step 3: 問題を生成
- 「問題を生成」ボタンをクリック
- 制約条件に基づいて問題の組み合わせを生成
- Problems.txtが自動的にダウンロードされます

### Step 4: AI解答を入力
- 生成されたProblems.txtをAIチャットに送信
- 提供されたプロンプトを使用してAIに解答を依頼
- AIから出力されたJSONをテキストエリアに貼り付け
- 「解答をインポート」ボタンをクリック

### Step 5: 完了
- 「スロット.xlsxをダウンロード」ボタンをクリック
- 完成したファイルがダウンロードされます

## 必要なExcelファイルの構造

### シート構成
- **Que_L**: 左側の問題パーツ
- **Que_C**: 中央の問題パーツ  
- **Que_R**: 右側の問題パーツ
- **Ans**: 解答シート（自動生成）
- **LC**: 左-中央の制約ペア
- **LR**: 左-右の制約ペア
- **CR**: 中央-右の制約ペア

### 列構成

#### Queシート（Que_L, Que_C, Que_R）
| A列 | B列 |
|-----|-----|
| type | question |

#### Ansシート
| A列 | B列 | C列 | D列 | E列 | F列 | G列 | H列 |
|-----|-----|-----|-----|-----|-----|-----|-----|
| row_L | row_C | row_R | ans | lie_answer1 | lie_answer2 | lie_answer3 | question |

#### 制約シート（LC, LR, CR）
| A列 | B列 |
|-----|-----|
| type_L/type_C | type_C/type_R |

## AIプロンプト

Problems.txtをAIに送信する際は、以下のプロンプトを使用してください：

```
アップロードしたProblemsの解答をjsonファイルで出力してください。具体的には、出力するjsonファイルのl問目の解答が以下のようになるようにしてください:

"id_1": (Problemsの左の番号),
"id_2": (Problemsの真ん中の番号),
"id_3": (Problemsの右の番号),
"D": (解答),
"E": (誤答例1),
"F": (誤答例2),
"G": (誤答例3)

ここに、(解答)はProblemsのl行目の問題の解答です。

なお、変数lは1からsまでの範囲を動きます。ここに、sはProblemsの行数を指します。
これは、コードを書かずに手作業で埋めてください。
なお、解答する際には以下の制約を満たすこと:
1.解答の初めに「絶対に」=をつけないこと
2.指数表記を使う際には^を用いること
3.三角関数がらみの解答をするときは、sin,cos,tan以外は使わないこと(例えばsecを使いたいときは、1/cosとすること)
4.整数/整数「のみ」で答えたいときは、必ず初めに'をつけること。
```

## 技術仕様

- **フロントエンド**: HTML5, CSS3, JavaScript (ES6+)
- **Excel処理**: SheetJS (xlsx.js)
- **対応形式**: .xlsx, .xls
- **ブラウザ**: モダンブラウザ（Chrome, Firefox, Safari, Edge）

## 注意事項

- ローカル環境での使用を想定しています
- 大きなExcelファイルの場合、処理に時間がかかる場合があります
- ブラウザのJavaScriptが有効になっている必要があります
- ファイルのダウンロードはブラウザの設定によって制限される場合があります

## トラブルシューティング

### ファイルが読み込めない
- ファイル形式が.xlsxまたは.xlsであることを確認
- ファイルが破損していないか確認
- ブラウザを再読み込みして再試行

### 検証でエラーが発生する
- 必要なシートがすべて存在するか確認
- 各シートの列名が正しく設定されているか確認
- テンプレートファイル（スロット-テンプレート.xlsx）と比較

### 問題が生成されない
- 制約シート（LC, LR, CR）にデータが正しく入力されているか確認
- Queシートに問題データが入力されているか確認
- 制約条件が適切に設定されているか確認

### JSONのインポートに失敗する
- JSONの形式が正しいか確認
- 必須フィールド（D, E, F, G）が含まれているか確認
- JSONの構文エラーがないか確認
